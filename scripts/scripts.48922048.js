"use strict";function Day(a,b){this.getName=function(){return a.toDateString()},this.getEvents=function(){return b}}angular.module("calendarApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/cal.html"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("calendarApp").controller("LayoutCtrl",["$scope","$rootScope",function(a,b){b.$on("$routeChangeSuccess",function(b,c){a.aboutActive="/about"===c.originalPath,a.homeActive=!a.aboutActive})}]),angular.module("calendarApp").controller("CalCtrl",["$scope","week","events",function(a,b,c){function d(){a.currentDate=f,a.days=[];for(var b=0;7>b;b++)a.days[b]=new Day(g[b],c.getEventsForDay(g[b]))}function e(){f=new Date,g=b.getDays(f),d()}var f,g;a.prevWeek=function(){f.setDate(f.getDate()-7),g=b.getDays(f),d()},a.nextWeek=function(){f.setDate(f.getDate()+7),g=b.getDays(f),d()},c.getAllEvents().promise.then(e)}]),angular.module("calendarApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("calendarApp").factory("week",function(){function a(a){return(a+6)%7}return{getDays:function(b){var c=[];null!==b&&b instanceof Date||(b=new Date);for(var d,e=a(b.getDay()),f=0;7>f;f++)d=a(f),c[d]=new Date(b.getTime()+864e5*(d-e));return c}}}),angular.module("calendarApp").factory("events",["$http","$q",function(a,b){function c(a,b,c){var d=100,e=0;this.getStartDate=function(){return a},this.getEndDate=function(){return b},this.getTitle=function(){return c},this.getPercentHeight=function(){return 100*(b-a)/864e5},this.getPercentTop=function(){return 100*(60*a.getHours()+a.getMinutes())/1440},this.getPercentWidth=function(){return d},this.setPercentWidth=function(a){d=a},this.getPercentLeft=function(){return e},this.setPercentLeft=function(a){e=a},this.getZindex=function(){return 1}}function d(a){for(var b=[],d=0;d<a.length;d++)b.push(new c(new Date(a[d].start.year,a[d].start.month,a[d].start.day,a[d].start.hour,a[d].start.minute),new Date(a[d].end.year,a[d].end.month,a[d].end.day,a[d].end.hour,a[d].end.minute),a[d].name));return b}function e(a){if(0!==a.length){a.sort(function(a,b){return a.getStartDate()-b.getStartDate()});var b=[[a[0]]],c=a[0].getEndDate();a.forEach(function(a,d){if(d>0)if(c>a.getStartDate())b[b.length-1].push(a),c=c.getTime()>a.getEndDate().getTime()?c:a.getEndDate();else{var e=100/b[b.length-1].length;b[b.length-1].forEach(function(a,b){a.setPercentWidth(e),a.setPercentLeft(b*e)}),c=a.getEndDate(),b.push([a])}})}}var f;return{getEventsForDay:function(a){for(var b=[],c=0;c<f.length;c++)(f[c].getStartDate().toDateString()===a.toDateString()||f[c].getEndDate().toDateString()===a.toDateString())&&b.push(f[c]);return e(b),b},getAllEvents:function(){var c=b.defer();return a.get("data/events.json").success(function(a){f=d(a),c.resolve()}),c}}}]);